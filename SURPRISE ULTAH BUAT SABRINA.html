<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Surprise Ulang Tahun - Buka Ini Dulu!</title>
  <meta name="description" content="Ucapan ulang tahun lucu, cepat, dan mudah di-share. Cocok dibuka lewat HP dari jauh." />
  <style>
    :root{--bg1:#ffefba;--bg2:#ffffff;--accent:#ff3d6f}
    *{box-sizing:border-box}
    html,body{height:100%;margin:0;font-family:Inter, 'Segoe UI', system-ui, -apple-system, 'Helvetica Neue', Arial}
    body{display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,var(--bg1),#ffd1dc);padding:20px}
    .wrap{width:100%;max-width:820px;background:linear-gradient(180deg,rgba(255,255,255,0.95),rgba(255,255,255,0.9));border-radius:20px;padding:22px;position:relative;overflow:hidden;box-shadow:0 12px 40px rgba(18,23,35,0.12)}
    header{display:flex;gap:14px;align-items:center}
    .cake{font-size:56px}
    h1{margin:0;font-size:clamp(20px,4.5vw,34px);color:#2b2b2b}
    p.lead{margin:6px 0 14px;color:#444}
    #bigMsg{background:linear-gradient(90deg,#fff,#fff);padding:16px;border-radius:12px;border:2px dashed rgba(0,0,0,0.06);font-size:18px;min-height:72px;display:flex;align-items:center;justify-content:center;text-align:center}
    .controls{display:flex;gap:10px;flex-wrap:wrap;justify-content:center;margin-top:14px}
    .btn{background:var(--accent);color:white;border:none;padding:12px 16px;border-radius:12px;font-weight:700;cursor:pointer;box-shadow:0 8px 20px rgba(255,61,111,0.18)}
    .btn.secondary{background:transparent;color:var(--accent);border:2px solid rgba(255,61,111,0.12);box-shadow:none}
    .small{font-size:13px;color:#666;margin-top:10px;text-align:center}
    footer{font-size:12px;color:#777;text-align:center;margin-top:12px}
    #countdown{font-size:48px;font-weight:800;color:var(--accent);margin-top:12px}
    .confettiCanvas{position:absolute;inset:0;pointer-events:none}
    .fun{font-family:'Comic Sans MS',cursive;}
    @media (max-width:460px){.cake{font-size:44px}#countdown{font-size:36px}}
  </style>
</head>
<body>
  <canvas id="confettiCanvas" class="confettiCanvas"></canvas>
  <div class="wrap">
    <header>
      <div class="cake" aria-hidden>üéÇ</div>
      <div>
        <h1 id="title">Selamat Ulang Tahun, Sayang!</h1>
        <p class="lead">Buka tombol <strong>"Mulai Surprise"</strong> ‚Äî jangan curi-curi intip dulu ya üòú</p>
      </div>
    </header>

    <div id="bigMsg">Hai <strong id="namePlace">Sayang</strong> ‚Äî siap untuk kejutan kecil yang lucu? ‚ù§Ô∏è</div>

    <div id="countdown" style="display:none">3</div>

    <div class="controls">
      <button class="btn" id="startBtn">üéâ Mulai Surprise</button>
      <button class="btn secondary" id="shareBtn">üîó Salin Link Personalisasi</button>
      <button class="btn secondary" id="jokeBtn">üòÇ Biar Receh</button>
    </div>

    <div class="small">Tip: tambahkan <code>?name=Amel&from=Reza&message=Love+you</code> di akhir URL untuk ubah teks tanpa edit file.</div>
    <footer>Made with üíñ ‚Äî Buka di HP supaya efek confetti dan musik terasa maksimal</footer>
  </div>

<script>
// --- Ambil query param ---
function qp(k,d){try{const u=new URL(location.href);return decodeURIComponent(u.searchParams.get(k) || d);}catch(e){return d;}}
const NAME = qp('name','Sayang');
const FROM = qp('from','Pacarmu');
const MESSAGE = qp('message','Semoga hari ini penuh kejutan manis dan kue enak!');

// Tampilkan personalisasi
document.getElementById('namePlace').textContent = NAME;
document.getElementById('bigMsg').innerHTML = `Hai <strong>${NAME}</strong> ‚Äî ${MESSAGE} <br><small style="color:#666">Dari: <strong>${FROM}</strong></small>`;

// --- Confetti (lightweight) ---
const canvas = document.getElementById('confettiCanvas'); const ctx = canvas.getContext('2d');
let W = canvas.width = window.innerWidth; let H = canvas.height = window.innerHeight; window.addEventListener('resize', ()=>{W=canvas.width=window.innerWidth;H=canvas.height=window.innerHeight});
let confs=[];
function spawnConfetti(n=140){confs=[];for(let i=0;i<n;i++){confs.push({x:Math.random()*W,y:Math.random()*-H*0.5,dx:(Math.random()-0.5)*3,dy:Math.random()*3+2,ang:Math.random()*360,s:Math.random()*6+4,c:`hsl(${Math.floor(Math.random()*360)},90%,60%)`})}};
function step(){ctx.clearRect(0,0,W,H);for(const p of confs){p.x+=p.dx; p.y+=p.dy; p.ang+=p.dx*2; ctx.save(); ctx.translate(p.x,p.y); ctx.rotate(p.ang*Math.PI/180); ctx.fillStyle=p.c; ctx.fillRect(-p.s/2,-p.s/2,p.s,p.s*0.6); ctx.restore(); if(p.y>H+40){p.y=-20;p.x=Math.random()*W}}requestAnimationFrame(step)}
spawnConfetti(0); step();

// --- WebAudio: main melody Happy Birthday ---
let audioCtx=null;
function ensureAudio(){if(!audioCtx) audioCtx = new (window.AudioContext || window.webkitAudioContext)();}
function playTone(freq, start, dur){const o = audioCtx.createOscillator(); const g = audioCtx.createGain(); o.type='sine'; o.frequency.setValueAtTime(freq, start); g.gain.setValueAtTime(0.0001, start); g.gain.exponentialRampToValueAtTime(0.12, start+0.02); g.gain.exponentialRampToValueAtTime(0.0001, start+dur-0.03); o.connect(g); g.connect(audioCtx.destination); o.start(start); o.stop(start+dur);
}
// happy birthday notes (freq in Hz)
const NOTES = {
  'C4':261.63,'D4':293.66,'E4':329.63,'F4':349.23,'G4':392.00,'A4':440.00,'B4':493.88,'C5':523.25,'D5':587.33,'E5':659.25
};
// sequence (note, duration in seconds)
const HB_SEQ = [
  ['G4',0.5],['G4',0.5],['A4',1],['G4',1],['C5',1],['B4',2],
  ['G4',0.5],['G4',0.5],['A4',1],['G4',1],['D5',1],['C5',2],
  ['G4',0.5],['G4',0.5],['G5',1],['E5',1],['C5',1],['B4',1],['A4',2],
  ['F5',0.5],['F5',0.5],['E5',1],['C5',1],['D5',1],['C5',2]
];
// Some notes might be undefined above; add them if needed
NOTES['G5'] = NOTES['G4']*2; NOTES['E5'] = NOTES['E4']*2; NOTES['F5']=NOTES['F4']*2;

function playHappyBirthday(){ensureAudio(); const now = audioCtx.currentTime + 0.1; let t = now; for(const [n,d] of HB_SEQ){const f = NOTES[n] || 440; playTone(f,t,d); t+=d;}}

// --- Countdown & flow ---
const startBtn = document.getElementById('startBtn'); const countdownEl = document.getElementById('countdown'); const bigMsg = document.getElementById('bigMsg');
startBtn.addEventListener('click', async ()=>{
  // resume audio on mobile if needed
  try{ ensureAudio(); if(audioCtx.state==='suspended') await audioCtx.resume(); }catch(e){}
  // kickoff
  spawnConfetti(160);
  let count = 3; countdownEl.style.display='block'; bigMsg.style.display='none';
  countdownEl.textContent = count;
  const iv = setInterval(()=>{count--; if(count>0){countdownEl.textContent = count;} else {clearInterval(iv); countdownEl.textContent='üéâ Surprise!!!'; setTimeout(()=>{countdownEl.style.display='none'; bigMsg.style.display='block'; bigMsg.innerHTML = `<div class=fun style="font-size:22px">üéä HBD ${NAME}!!! üéä</div><div style="margin-top:8px;color:#444">${MESSAGE}<br><small>Dari: <strong>${FROM}</strong></small></div>`; spawnConfetti(220); playHappyBirthday();},700);} },1000);
});

// --- Share link ---
document.getElementById('shareBtn').addEventListener('click', async ()=>{
  const base = location.origin + location.pathname;
  const params = new URLSearchParams({name: NAME, from: FROM, message: MESSAGE});
  const link = `${base}?${params.toString()}`;
  try{ await navigator.clipboard.writeText(link); alert('Link personalisasi disalin ke clipboard. Tinggal kirim ke pacar kamu!'); }
  catch(e){ prompt('Salin link ini:', link); }
});

// --- Jokereceh ---
const jokes = [
  'Kue ulang tahun bilang ke sendok: jangan cemburu, aku cuma manis ke dia.',
  'Kenapa kue nggak pernah sedih? Karena dia selalu ada topping baru. üòÇ',
  'Kamu itu kayak kue ‚Äî semakin lama makin enak, tapi jangan kebanyakan makan ya!' 
];
const jokeBtn = document.getElementById('jokeBtn'); jokeBtn.addEventListener('click', ()=>{const j=jokes[Math.floor(Math.random()*jokes.length)]; bigMsg.innerHTML = `<div class=fun style="font-size:18px">${j}</div><div style="margin-top:8px;color:#666;font-size:13px">Still love you, ${NAME} ‚ù§Ô∏è</div>`});

// Accessibility: allow pressing Enter on startBtn
startBtn.addEventListener('keydown', (e)=>{ if(e.key==='Enter') startBtn.click(); });

</script>
</body>
</html>
